#pragma once

namespace Quadrature {

	namespace Gauss_Legendre {

		template<int N>
		inline const double* Points() { return nullptr; };
		template<int N>
		inline const double* Weight() { return nullptr; };

		static constexpr const double points4[4] = {
				-0.861136311594052575224,
				-0.3399810435848562648027,
				0.3399810435848562648027,
				0.861136311594052575224
		};
		template<>
		inline const double* Points<4>() { return points4; }

		static constexpr const double weight4[4] = {
				0.3478548451374538573731,
				0.6521451548625461426269,
				0.6521451548625461426269,
				0.3478548451374538573731
		};

		template<>
		inline const double* Weight<4>() { return weight4; }


		static constexpr const double points8[8] = {
				-0.9602898564975362316836,
				-0.7966664774136267395916,
				-0.5255324099163289858177,
				-0.1834346424956498049395,
				0.1834346424956498049395,
				0.5255324099163289858177,
				0.7966664774136267395916,
				0.9602898564975362316836,
		};
		template<>
		inline const double* Points<8>() { return points8; }

		static constexpr const double weight8[8] = {
				0.1012285362903762591525,
				0.2223810344533744705444,
				0.313706645877887287338,
				0.3626837833783619829652,
				0.3626837833783619829652,
				0.313706645877887287338,
				0.222381034453374470544,
				0.1012285362903762591525,
		};
		template<>
		inline const double* Weight<8>() { return weight8; }


		static constexpr const double points16[16] = {
				-0.9894009349916499325962,
				-0.944575023073232576078,
				-0.8656312023878317438805,
				-0.7554044083550030338951,
				-0.6178762444026437484467,
				-0.4580167776572273863424,
				-0.2816035507792589132305,
				-0.0950125098376374401853,
				0.0950125098376374401853,
				0.28160355077925891323,
				0.458016777657227386342,
				0.617876244402643748447,
				0.7554044083550030338951,
				0.8656312023878317438805,
				0.944575023073232576078,
				0.9894009349916499325962,
		};
		template<>
		inline const double* Points<16>() { return points16; }

		static constexpr const double weight16[16] = {
				0.02715245941175409485178,
				0.0622535239386478928628,
				0.0951585116824927848099,
				0.1246289712555338720525,
				0.1495959888165767320815,
				0.169156519395002538189,
				0.1826034150449235888668,
				0.1894506104550684962854,
				0.189450610455068496285,
				0.182603415044923588867,
				0.1691565193950025381893,
				0.149595988816576732082,
				0.124628971255533872052,
				0.0951585116824927848099,
				0.0622535239386478928628,
				0.0271524594117540948518,
		};
		template<>
		inline const double* Weight<16>() { return weight16; }


		static constexpr const double points32[32] = {
				-0.997263861849481563545,
				-0.9856115115452683354002,
				-0.9647622555875064307738,
				-0.9349060759377396891709,
				-0.8963211557660521239653,
				-0.8493676137325699701337,
				-0.794483795967942406963,
				-0.7321821187402896803874,
				-0.6630442669302152009751,
				-0.5877157572407623290408,
				-0.5068999089322293900238,
				-0.421351276130635345364,
				-0.3318686022821276497799,
				-0.2392873622521370745446,
				-0.1444719615827964934852,
				-0.0483076656877383162348,
				0.048307665687738316235,
				0.1444719615827964934852,
				0.2392873622521370745446,
				0.33186860228212764978,
				0.4213512761306353453641,
				0.5068999089322293900238,
				0.5877157572407623290408,
				0.6630442669302152009751,
				0.7321821187402896803874,
				0.7944837959679424069631,
				0.8493676137325699701337,
				0.8963211557660521239653,
				0.9349060759377396891709,
				0.9647622555875064307738,
				0.9856115115452683354002,
				0.997263861849481563545,
		};
		template<>
		inline const double* Points<32>() { return points32; }

		static constexpr const double weight32[32] = {
				0.0070186100094700966004,
				0.0162743947309056706052,
				0.0253920653092620594558,
				0.0342738629130214331027,
				0.0428358980222266806569,
				0.050998059262376176196,
				0.0586840934785355471453,
				0.065822222776361846838,
				0.072345794108848506225,
				0.0781938957870703064717,
				0.0833119242269467552222,
				0.087652093004403811143,
				0.091173878695763884713,
				0.09384439908080456563918,
				0.0956387200792748594191,
				0.0965400885147278005668,
				0.0965400885147278005668,
				0.0956387200792748594191,
				0.0938443990808045656392,
				0.091173878695763884713,
				0.0876520930044038111428,
				0.083311924226946755222,
				0.078193895787070306472,
				0.072345794108848506225,
				0.065822222776361846838,
				0.0586840934785355471453,
				0.0509980592623761761962,
				0.0428358980222266806569,
				0.0342738629130214331027,
				0.0253920653092620594558,
				0.0162743947309056706052,
				0.0070186100094700966004,
		};
		template<>
		inline const double* Weight<32>() { return weight32; }

		static constexpr const double points64[64] = {
				-0.9993050417357721394569,
				-0.9963401167719552793469,
				-0.9910133714767443207394,
				-0.9833362538846259569313,
				-0.9733268277899109637419,
				-0.9610087996520537189186,
				-0.9464113748584028160625,
				-0.9295691721319395758215,
				-0.9105221370785028057564,
				-0.8893154459951141058534,
				-0.8659993981540928197608,
				-0.840629296252580362752,
				-0.813265315122797559742,
				-0.7839723589433414076102,
				-0.752819907260531896612,
				-0.7198818501716108268489,
				-0.6852363130542332425636,
				-0.648965471254657339858,
				-0.6111553551723932502489,
				-0.5718956462026340342839,
				-0.531279464019894545658,
				-0.4894031457070529574785,
				-0.4463660172534640879849,
				-0.4022701579639916036958,
				-0.3572201583376681159504,
				-0.3113228719902109561575,
				-0.264687162208767416374,
				-0.2174236437400070841496,
				-0.1696444204239928180373,
				-0.1214628192961205544704,
				-0.0729931217877990394495,
				-0.02435029266342443250896,
				0.024350292663424432509,
				0.0729931217877990394495,
				0.1214628192961205544704,
				0.1696444204239928180373,
				0.2174236437400070841496,
				0.264687162208767416374,
				0.311322871990210956158,
				0.3572201583376681159504,
				0.4022701579639916036958,
				0.4463660172534640879849,
				0.489403145707052957479,
				0.531279464019894545658,
				0.5718956462026340342839,
				0.611155355172393250249,
				0.6489654712546573398578,
				0.6852363130542332425636,
				0.7198818501716108268489,
				0.7528199072605318966119,
				0.7839723589433414076102,
				0.8132653151227975597419,
				0.8406292962525803627517,
				0.8659993981540928197608,
				0.8893154459951141058534,
				0.9105221370785028057564,
				0.9295691721319395758215,
				0.9464113748584028160625,
				0.9610087996520537189186,
				0.9733268277899109637419,
				0.9833362538846259569313,
				0.9910133714767443207394,
				0.9963401167719552793469,
				0.9993050417357721394569,
		};
		template<>
		inline const double* Points<64>() { return points64; }

		static constexpr const double weight64[64] = {
			0.0017832807216964329473,
			0.0041470332605624676353,
			0.006504457968978362856,
			0.008846759826363947723,
			0.0111681394601311288186,
			0.0134630478967186425981,
			0.015726030476024719322,
			0.01795171577569734308505,
			0.020134823153530209372,
			0.0222701738083832541593,
			0.0243527025687108733382,
			0.026377469715054658672,
			0.0283396726142594832275,
			0.03023465707240247886797,
			0.0320579283548515535855,
			0.03380516183714160939157,
			0.0354722132568823838107,
			0.0370551285402400460404,
			0.038550153178615629129,
			0.0399537411327203413867,
			0.04126256324262352861,
			0.04247351512365358900734,
			0.043583724529323453377,
			0.04459055816375656306,
			0.0454916279274181444798,
			0.046284796581314417296,
			0.04696818281621001732533,
			0.0475401657148303086623,
			0.047999388596458307728,
			0.0483447622348029571698,
			0.0485754674415034269348,
			0.0486909570091397203834,
			0.0486909570091397203834,
			0.048575467441503426935,
			0.04834476223480295717,
			0.0479993885964583077281,
			0.0475401657148303086623,
			0.046968182816210017325,
			0.046284796581314417296,
			0.04549162792741814448,
			0.0445905581637565630601,
			0.043583724529323453377,
			0.042473515123653589007,
			0.0412625632426235286102,
			0.0399537411327203413867,
			0.038550153178615629129,
			0.0370551285402400460404,
			0.03547221325688238381069,
			0.033805161837141609392,
			0.032057928354851553585,
			0.030234657072402478868,
			0.0283396726142594832275,
			0.026377469715054658672,
			0.024352702568710873338,
			0.0222701738083832541593,
			0.0201348231535302093723,
			0.017951715775697343085,
			0.015726030476024719322,
			0.0134630478967186425981,
			0.0111681394601311288186,
			0.008846759826363947723,
			0.006504457968978362856,
			0.0041470332605624676353,
			0.0017832807216964329473,
		};
		template<>
		inline const double* Weight<64>() { return weight64; }


		template<int N, class FUNC>
		inline double Integrate(FUNC F) {
			const double* x = Points<N>();
			const double* w = Weight<N>();

			double sum = 0.0;
			for (int i = 0; i < N; ++i) {
				sum += F(x[i]) * w[i];
			}
			return sum;
		}

		template<int N, class T, class FUNC>
		inline T IntegrateT(FUNC F) {
			const double* x = Points<N>();
			const double* w = Weight<N>();

			T sum{};
			for (int i = 0; i < N; ++i) {
				sum += F(x[i]) * w[i];
			}
			return sum;
		}
	}

}
